# TourismAnalysis
重庆大学毕业实习大数据项目

## 接口规范

### 爬虫与后端

爬虫使用SQLite数据库向后端提交原始数据，该数据库中的表描述如下：

#### stories

该表描述游记实体。

| 字段       | 类型 | 描述       | 备注                               |
| ---------- | ---- | ---------- | ---------------------------------- |
| stid       | int  | 游记编号   | 主键，与原始网站中编号规则保持一致 |
| cost       | int  | 人均消费   | 单位：元                           |
| auth       | str  | 作者用户名 |                                    |
| relp       | str  | 参与者关系 |                                    |
| title      | str  | 标题       |                                    |
| date_start | str  | 开始日期   | 格式：YYYY-mm-dd                   |
| date_count | int  | 持续时间   | 单位：天                           |
| text_count | int  | 正文字数   |                                    |
| pict_count | int  | 图片数量   |                                    |
| cmmt_count | int  | 评论数量   |                                    |
| like_count | int  | 点赞数量   |                                    |
| view_count | int  | 浏览数量   |                                    |

#### scenics

该表描述景点实体。

| 字段 | 类型 | 描述     | 备注                               |
| ---- | ---- | -------- | ---------------------------------- |
| scid | int  | 景点编号 | 主键，与原始网站中编号规则保持一致 |
| name | str  | 景点名称 |                                    |
| city | int  | 所属城市 |                                    |

虽然称为景点，但该实体也会描述诸如酒店、机场等其它地点。

#### cities

该表描述城市实体。

| 字段 | 类型 | 描述     | 备注                               |
| ---- | ---- | -------- | ---------------------------------- |
| ctid | int  | 城市编号 | 主键，与原始网站中编号规则保持一致 |
| name | str  | 城市名称 |                                    |
| prov | str  | 所属省份 | 国外城市统一属于“国外”省份         |

#### visits

该表描述游记中提及景点和城市的情况。

| 字段  | 类型 | 描述                       | 备注         |
| ----- | ---- | -------------------------- | ------------ |
| vstid | int  | 对应游记编号               | 游记表的外键 |
| index | int  | 游记中的出现次序，从零开始 |              |
| vscid | int  | 对应景点编号               | 景点表的外键 |
| vctid | int  | 对应城市编号               | 城市表的外键 |

字段`vstid`和`index`为该表的复合主键，字段`vscid`和`vctid`有且只有一个非空。

#### how_to

该表描述游记的玩法标签。

| 字段  | 类型 | 描述         | 备注         |
| ----- | ---- | ------------ | ------------ |
| hstid | int  | 对应游记编号 | 游记表的外键 |
| h_tag | str  | 标签内容     |              |

## 注意事项

- 请提交能通过编译的、经过充分测试的代码，至少自己手动测试一下。
- 请提交格式规范的代码，推荐使用IDE的自动格式化功能格式化代码。
- 提交信息请使用中文，描述一下本次提交实现了哪些功能。
- 已知的BUG和尚未实现的功能请使用FIXME和TODO标注。
- 代码请存放在对应的目录下，如爬虫存放在`spiders`目录下，服务器（包括后端和前端）存放在`server`目录下；提交时请在同名分支下提交。





## 接口 

### 出行人数


##### 简要描述

- 月份平均出行人数

##### 请求URL
- ` /month_avg_people/ `
##### 请求方式
- GET 

##### 参数



##### 返回示例 

``` 
  {
    "error_code": 100,
    "data": {
      "month": 12,
      "people_num":2345,
    }
  }
```

##### 返回参数说明 

| 参数名     | 类型 | 说明             |
| :--------- | :--- | ---------------- |
| month      | int  | 月份             |
| people_num | int  | 每月年均出行人数 |



### 人均消费


##### 简要描述

- 获取人物对应的人均消费

##### 请求URL
- ` /relp_avg_cost/ `
##### 请求方式
- GET 

##### 参数

##### 返回示例 

``` 
  {
    "error_code": 100 ,
    "data": [{
      "relp":"闺蜜",
      "avg_cost": 2345}
	]
  }
```

##### 返回参数说明 

| 参数名   | 类型   | 说明                     |
| :------- | :----- | ------------------------ |
| relp     | string | 人物关系                 |
| avg_cost | int    | 对应的人物关系的人均消费 |

##### 备注 

- 更多返回错误代码请看首页的错误代码描述

